var data =
[
  {
    "Day": "2018-02-01",
    "Time": "0:00:00",
    "Average": -0.810731111
  },
  {
    "Day": "2018-02-01",
    "Time": "1:00:00",
    "Average": -0.854032222
  },
  {
    "Day": "2018-02-01",
    "Time": "2:00:00",
    "Average": -0.779398333
  },
  {
    "Day": "2018-02-01",
    "Time": "3:00:00",
    "Average": -1.001266111
  },
  {
    "Day": "2018-02-01",
    "Time": "4:00:00",
    "Average": -0.772486111
  },
  {
    "Day": "2018-02-01",
    "Time": "5:00:00",
    "Average": -1.366836111
  },
  {
    "Day": "2018-02-01",
    "Time": "6:00:00",
    "Average": -5.351875556
  },
  {
    "Day": "2018-02-01",
    "Time": "7:00:00",
    "Average": -0.930178056
  },
  {
    "Day": "2018-02-01",
    "Time": "8:00:00",
    "Average": -0.8471525
  },
  {
    "Day": "2018-02-01",
    "Time": "9:00:00",
    "Average": -1.103427778
  },
  {
    "Day": "2018-02-01",
    "Time": "10:00:00",
    "Average": -0.896116667
  },
  {
    "Day": "2018-02-01",
    "Time": "11:00:00",
    "Average": -1.587593333
  },
  {
    "Day": "2018-02-01",
    "Time": "12:00:00",
    "Average": -1.603836944
  },
  {
    "Day": "2018-02-01",
    "Time": "13:00:00",
    "Average": -1.947245
  },
  {
    "Day": "2018-02-01",
    "Time": "14:00:00",
    "Average": -1.903953056
  },
  {
    "Day": "2018-02-01",
    "Time": "15:00:00",
    "Average": -2.090414167
  },
  {
    "Day": "2018-02-01",
    "Time": "16:00:00",
    "Average": -2.527993611
  },
  {
    "Day": "2018-02-01",
    "Time": "17:00:00",
    "Average": -1.902608333
  },
  {
    "Day": "2018-02-01",
    "Time": "18:00:00",
    "Average": -2.194451111
  },
  {
    "Day": "2018-02-01",
    "Time": "19:00:00",
    "Average": -1.387328889
  },
  {
    "Day": "2018-02-01",
    "Time": "20:00:00",
    "Average": -1.444418889
  },
  {
    "Day": "2018-02-01",
    "Time": "21:00:00",
    "Average": -1.333861389
  },
  {
    "Day": "2018-02-01",
    "Time": "22:00:00",
    "Average": -1.317825833
  },
  {
    "Day": "2018-02-01",
    "Time": "23:00:00",
    "Average": -1.008665833
  },
  {
    "Day": "2018-02-02",
    "Time": "0:00:00",
    "Average": -0.970281111
  },
  {
    "Day": "2018-02-02",
    "Time": "1:00:00",
    "Average": -0.760575278
  },
  {
    "Day": "2018-02-02",
    "Time": "2:00:00",
    "Average": -0.847307778
  },
  {
    "Day": "2018-02-02",
    "Time": "3:00:00",
    "Average": -0.789568333
  },
  {
    "Day": "2018-02-02",
    "Time": "4:00:00",
    "Average": -0.807562778
  },
  {
    "Day": "2018-02-02",
    "Time": "5:00:00",
    "Average": -4.441782778
  },
  {
    "Day": "2018-02-02",
    "Time": "6:00:00",
    "Average": -1.128928611
  },
  {
    "Day": "2018-02-02",
    "Time": "7:00:00",
    "Average": -0.895322778
  },
  {
    "Day": "2018-02-02",
    "Time": "8:00:00",
    "Average": -0.963201111
  },
  {
    "Day": "2018-02-02",
    "Time": "9:00:00",
    "Average": -3.727507778
  },
  {
    "Day": "2018-02-02",
    "Time": "10:00:00",
    "Average": -3.171833611
  },
  {
    "Day": "2018-02-02",
    "Time": "11:00:00",
    "Average": -1.114075
  },
  {
    "Day": "2018-02-02",
    "Time": "12:00:00",
    "Average": -1.307629722
  },
  {
    "Day": "2018-02-02",
    "Time": "13:00:00",
    "Average": -0.84179
  },
  {
    "Day": "2018-02-02",
    "Time": "14:00:00",
    "Average": -0.879339444
  },
  {
    "Day": "2018-02-02",
    "Time": "15:00:00",
    "Average": -0.887795833
  },
  {
    "Day": "2018-02-02",
    "Time": "16:00:00",
    "Average": -0.845403333
  },
  {
    "Day": "2018-02-02",
    "Time": "17:00:00",
    "Average": -1.399626944
  },
  {
    "Day": "2018-02-02",
    "Time": "18:00:00",
    "Average": -1.836004444
  },
  {
    "Day": "2018-02-02",
    "Time": "19:00:00",
    "Average": -1.653632778
  },
  {
    "Day": "2018-02-02",
    "Time": "20:00:00",
    "Average": -1.175896667
  },
  {
    "Day": "2018-02-02",
    "Time": "21:00:00",
    "Average": -1.198528056
  },
  {
    "Day": "2018-02-02",
    "Time": "22:00:00",
    "Average": -1.107061944
  },
  {
    "Day": "2018-02-02",
    "Time": "23:00:00",
    "Average": -0.967039167
  },
  {
    "Day": "2018-02-03",
    "Time": "0:00:00",
    "Average": -0.853393611
  },
  {
    "Day": "2018-02-03",
    "Time": "1:00:00",
    "Average": -0.821531111
  },
  {
    "Day": "2018-02-03",
    "Time": "2:00:00",
    "Average": -0.802110278
  },
  {
    "Day": "2018-02-03",
    "Time": "3:00:00",
    "Average": -0.807253056
  },
  {
    "Day": "2018-02-03",
    "Time": "4:00:00",
    "Average": -0.820225
  },
  {
    "Day": "2018-02-03",
    "Time": "5:00:00",
    "Average": -0.745169722
  },
  {
    "Day": "2018-02-03",
    "Time": "6:00:00",
    "Average": -1.116466667
  },
  {
    "Day": "2018-02-03",
    "Time": "7:00:00",
    "Average": -0.948942222
  },
  {
    "Day": "2018-02-03",
    "Time": "8:00:00",
    "Average": -1.266022778
  },
  {
    "Day": "2018-02-03",
    "Time": "9:00:00",
    "Average": -2.530329444
  },
  {
    "Day": "2018-02-03",
    "Time": "10:00:00",
    "Average": -2.443143611
  },
  {
    "Day": "2018-02-03",
    "Time": "11:00:00",
    "Average": -1.023635833
  },
  {
    "Day": "2018-02-03",
    "Time": "12:00:00",
    "Average": -1.002768889
  },
  {
    "Day": "2018-02-03",
    "Time": "13:00:00",
    "Average": -0.991170278
  },
  {
    "Day": "2018-02-03",
    "Time": "14:00:00",
    "Average": -1.01968
  },
  {
    "Day": "2018-02-03",
    "Time": "15:00:00",
    "Average": -1.053948056
  },
  {
    "Day": "2018-02-03",
    "Time": "16:00:00",
    "Average": -1.017785
  },
  {
    "Day": "2018-02-03",
    "Time": "17:00:00",
    "Average": -2.0893725
  },
  {
    "Day": "2018-02-03",
    "Time": "18:00:00",
    "Average": -2.564026944
  },
  {
    "Day": "2018-02-03",
    "Time": "19:00:00",
    "Average": -1.419140278
  },
  {
    "Day": "2018-02-03",
    "Time": "20:00:00",
    "Average": -1.160446389
  },
  {
    "Day": "2018-02-03",
    "Time": "21:00:00",
    "Average": -1.117294722
  },
  {
    "Day": "2018-02-03",
    "Time": "22:00:00",
    "Average": -1.035483333
  },
  {
    "Day": "2018-02-03",
    "Time": "23:00:00",
    "Average": -1.001243889
  },
  {
    "Day": "2018-02-04",
    "Time": "0:00:00",
    "Average": -0.912847778
  },
  {
    "Day": "2018-02-04",
    "Time": "1:00:00",
    "Average": -0.864925278
  },
  {
    "Day": "2018-02-04",
    "Time": "2:00:00",
    "Average": -0.841657778
  },
  {
    "Day": "2018-02-04",
    "Time": "3:00:00",
    "Average": -0.836707222
  },
  {
    "Day": "2018-02-04",
    "Time": "4:00:00",
    "Average": -0.845925556
  },
  {
    "Day": "2018-02-04",
    "Time": "5:00:00",
    "Average": -0.806613333
  },
  {
    "Day": "2018-02-04",
    "Time": "6:00:00",
    "Average": -0.875876944
  },
  {
    "Day": "2018-02-04",
    "Time": "7:00:00",
    "Average": -1.2113675
  },
  {
    "Day": "2018-02-04",
    "Time": "8:00:00",
    "Average": -1.195803333
  },
  {
    "Day": "2018-02-04",
    "Time": "9:00:00",
    "Average": -2.871292778
  },
  {
    "Day": "2018-02-04",
    "Time": "10:00:00",
    "Average": -0.977034444
  },
  {
    "Day": "2018-02-04",
    "Time": "11:00:00",
    "Average": -1.083446667
  },
  {
    "Day": "2018-02-04",
    "Time": "12:00:00",
    "Average": -0.999502222
  },
  {
    "Day": "2018-02-04",
    "Time": "13:00:00",
    "Average": -1.4182875
  },
  {
    "Day": "2018-02-04",
    "Time": "14:00:00",
    "Average": -4.198189444
  },
  {
    "Day": "2018-02-04",
    "Time": "15:00:00",
    "Average": -2.445306667
  },
  {
    "Day": "2018-02-04",
    "Time": "16:00:00",
    "Average": -2.267550833
  },
  {
    "Day": "2018-02-04",
    "Time": "17:00:00",
    "Average": -0.853485833
  },
  {
    "Day": "2018-02-04",
    "Time": "18:00:00",
    "Average": -2.493114167
  },
  {
    "Day": "2018-02-04",
    "Time": "19:00:00",
    "Average": -1.792099167
  },
  {
    "Day": "2018-02-04",
    "Time": "20:00:00",
    "Average": -1.310113889
  },
  {
    "Day": "2018-02-04",
    "Time": "21:00:00",
    "Average": -1.119072778
  },
  {
    "Day": "2018-02-04",
    "Time": "22:00:00",
    "Average": -1.177116389
  },
  {
    "Day": "2018-02-04",
    "Time": "23:00:00",
    "Average": -0.881216111
  },
  {
    "Day": "2018-02-05",
    "Time": "0:00:00",
    "Average": -0.865413333
  },
  {
    "Day": "2018-02-05",
    "Time": "1:00:00",
    "Average": -0.729182778
  },
  {
    "Day": "2018-02-05",
    "Time": "2:00:00",
    "Average": -0.795785278
  },
  {
    "Day": "2018-02-05",
    "Time": "3:00:00",
    "Average": -0.719474722
  },
  {
    "Day": "2018-02-05",
    "Time": "4:00:00",
    "Average": -0.792009722
  },
  {
    "Day": "2018-02-05",
    "Time": "5:00:00",
    "Average": -0.735086944
  },
  {
    "Day": "2018-02-05",
    "Time": "6:00:00",
    "Average": -0.7974325
  },
  {
    "Day": "2018-02-05",
    "Time": "7:00:00",
    "Average": -1.352551111
  },
  {
    "Day": "2018-02-05",
    "Time": "8:00:00",
    "Average": -1.059458889
  },
  {
    "Day": "2018-02-05",
    "Time": "9:00:00",
    "Average": -1.2680675
  },
  {
    "Day": "2018-02-05",
    "Time": "10:00:00",
    "Average": -1.221813056
  },
  {
    "Day": "2018-02-05",
    "Time": "11:00:00",
    "Average": -0.927473333
  },
  {
    "Day": "2018-02-05",
    "Time": "12:00:00",
    "Average": -0.886583056
  },
  {
    "Day": "2018-02-05",
    "Time": "13:00:00",
    "Average": -2.556908333
  },
  {
    "Day": "2018-02-05",
    "Time": "14:00:00",
    "Average": -0.964518889
  },
  {
    "Day": "2018-02-05",
    "Time": "15:00:00",
    "Average": -0.989088889
  },
  {
    "Day": "2018-02-05",
    "Time": "16:00:00",
    "Average": -0.878259444
  },
  {
    "Day": "2018-02-05",
    "Time": "17:00:00",
    "Average": -1.073628056
  },
  {
    "Day": "2018-02-05",
    "Time": "18:00:00",
    "Average": -2.701273889
  },
  {
    "Day": "2018-02-05",
    "Time": "19:00:00",
    "Average": -1.983367778
  },
  {
    "Day": "2018-02-05",
    "Time": "20:00:00",
    "Average": -0.965796667
  },
  {
    "Day": "2018-02-05",
    "Time": "21:00:00",
    "Average": -1.114409722
  },
  {
    "Day": "2018-02-05",
    "Time": "22:00:00",
    "Average": -1.010339444
  },
  {
    "Day": "2018-02-05",
    "Time": "23:00:00",
    "Average": -0.987864722
  },
  {
    "Day": "2018-02-06",
    "Time": "0:00:00",
    "Average": -0.730950278
  },
  {
    "Day": "2018-02-06",
    "Time": "1:00:00",
    "Average": -0.781366111
  },
  {
    "Day": "2018-02-06",
    "Time": "2:00:00",
    "Average": -0.731214167
  },
  {
    "Day": "2018-02-06",
    "Time": "3:00:00",
    "Average": -0.927974722
  },
  {
    "Day": "2018-02-06",
    "Time": "4:00:00",
    "Average": -0.746295278
  },
  {
    "Day": "2018-02-06",
    "Time": "5:00:00",
    "Average": -0.760603333
  },
  {
    "Day": "2018-02-06",
    "Time": "6:00:00",
    "Average": -0.926404722
  },
  {
    "Day": "2018-02-06",
    "Time": "7:00:00",
    "Average": -1.175036667
  },
  {
    "Day": "2018-02-06",
    "Time": "8:00:00",
    "Average": -0.989188333
  },
  {
    "Day": "2018-02-06",
    "Time": "9:00:00",
    "Average": -1.024973889
  },
  {
    "Day": "2018-02-06",
    "Time": "10:00:00",
    "Average": -1.140368056
  },
  {
    "Day": "2018-02-06",
    "Time": "11:00:00",
    "Average": -1.141459444
  },
  {
    "Day": "2018-02-06",
    "Time": "12:00:00",
    "Average": -0.879803056
  },
  {
    "Day": "2018-02-06",
    "Time": "13:00:00",
    "Average": -1.338048333
  },
  {
    "Day": "2018-02-06",
    "Time": "14:00:00",
    "Average": -4.12608
  },
  {
    "Day": "2018-02-06",
    "Time": "15:00:00",
    "Average": -1.599181944
  },
  {
    "Day": "2018-02-06",
    "Time": "16:00:00",
    "Average": -0.973443056
  },
  {
    "Day": "2018-02-06",
    "Time": "17:00:00",
    "Average": -1.332719167
  },
  {
    "Day": "2018-02-06",
    "Time": "18:00:00",
    "Average": -1.684173889
  },
  {
    "Day": "2018-02-06",
    "Time": "19:00:00",
    "Average": -2.835693056
  },
  {
    "Day": "2018-02-06",
    "Time": "20:00:00",
    "Average": -1.417078333
  },
  {
    "Day": "2018-02-06",
    "Time": "21:00:00",
    "Average": -1.196196389
  },
  {
    "Day": "2018-02-06",
    "Time": "22:00:00",
    "Average": -1.243494722
  },
  {
    "Day": "2018-02-06",
    "Time": "23:00:00",
    "Average": -1.040369722
  },
  {
    "Day": "2018-02-07",
    "Time": "0:00:00",
    "Average": -0.961408889
  },
  {
    "Day": "2018-02-07",
    "Time": "1:00:00",
    "Average": -0.8044675
  },
  {
    "Day": "2018-02-07",
    "Time": "2:00:00",
    "Average": -0.8575925
  },
  {
    "Day": "2018-02-07",
    "Time": "3:00:00",
    "Average": -0.860923889
  },
  {
    "Day": "2018-02-07",
    "Time": "4:00:00",
    "Average": -0.779375
  },
  {
    "Day": "2018-02-07",
    "Time": "5:00:00",
    "Average": -0.841193056
  },
  {
    "Day": "2018-02-07",
    "Time": "6:00:00",
    "Average": -0.926695278
  },
  {
    "Day": "2018-02-07",
    "Time": "7:00:00",
    "Average": -0.947858611
  },
  {
    "Day": "2018-02-07",
    "Time": "8:00:00",
    "Average": -0.949723889
  },
  {
    "Day": "2018-02-07",
    "Time": "9:00:00",
    "Average": -3.436226667
  },
  {
    "Day": "2018-02-07",
    "Time": "10:00:00",
    "Average": -2.983789444
  },
  {
    "Day": "2018-02-07",
    "Time": "11:00:00",
    "Average": -1.817064167
  },
  {
    "Day": "2018-02-07",
    "Time": "12:00:00",
    "Average": -0.857542778
  },
  {
    "Day": "2018-02-07",
    "Time": "13:00:00",
    "Average": -0.926436389
  },
  {
    "Day": "2018-02-07",
    "Time": "14:00:00",
    "Average": -1.588249167
  },
  {
    "Day": "2018-02-07",
    "Time": "15:00:00",
    "Average": -1.751493611
  },
  {
    "Day": "2018-02-07",
    "Time": "16:00:00",
    "Average": -1.056120278
  },
  {
    "Day": "2018-02-07",
    "Time": "17:00:00",
    "Average": -2.652868333
  },
  {
    "Day": "2018-02-07",
    "Time": "18:00:00",
    "Average": -1.887218333
  },
  {
    "Day": "2018-02-07",
    "Time": "19:00:00",
    "Average": -1.652267222
  },
  {
    "Day": "2018-02-07",
    "Time": "20:00:00",
    "Average": -1.536907778
  },
  {
    "Day": "2018-02-07",
    "Time": "21:00:00",
    "Average": -1.116818333
  },
  {
    "Day": "2018-02-07",
    "Time": "22:00:00",
    "Average": -1.147456111
  },
  {
    "Day": "2018-02-07",
    "Time": "23:00:00",
    "Average": -0.888740278
  }
];

var radial_labels = ["Thursday", "Friday", "Saturday", "Sunday", "Monday", "Tuesday", "Wednesday"];

var segment_labels = ["Midnight", "1am", "2am", "3am", "4am", "5am", "6am", "7am", "8am", "9am", "10am", 
    "11am", "Midday", "1pm", "2pm", "3pm", "4pm", "5pm", "6pm", "7pm", "8pm", "9pm", "10pm", "11pm"];


loadCircularHeatMap(data, "#chart", radial_labels, segment_labels);

loadCircularHeatMap(data,"#chart",radial_labels, segment_labels);
	
	
	function loadCircularHeatMap (dataset, dom_element_to_append_to,radial_labels,segment_labels) {

    var margin = {top: 50, right: 50, bottom: 50, left: 50};
    var width = 1000 - margin.left - margin.right;

    var height = width;
    var innerRadius = 100;// width/14;
    
    var segmentHeight = (width - margin.top - margin.bottom - 2*innerRadius )/(2*radial_labels.length);

    var chart = circularHeatChart()
    .innerRadius(innerRadius)
    .segmentHeight(segmentHeight)
    .domain([-0,-0.5,-1])
    .range(["#fee8c8", "#fdbb84" ,"#e34a33"])
    .radialLabels(radial_labels)
    .segmentLabels(segment_labels);

    chart.accessor(function(d) {return d.Average;})

    var svg = d3.select(dom_element_to_append_to)
    .selectAll('svg')
    .data([dataset])
    .enter()
    .append('svg')
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
    .append('g')
    .attr("transform",
        "translate(" + ( (width )/2 - (radial_labels.length*segmentHeight + innerRadius)  ) + "," + margin.top + ")")
    .call(chart);
    
    


    var tooltip = d3.select(dom_element_to_append_to)
    .append('div')
    .attr('class', 'tooltip');

    tooltip.append('div')
    .attr('class', 'time');
    tooltip.append('div')
    .attr('class', 'average');
    tooltip.append('div')
    .attr('class', 'day');

    svg.selectAll("path")
    .on('mouseover', function(d) {
    	console.log(d.Day);
    	// increase the segment height of the one being hovered as well as all others of the same date
    	// while decreasing the height of all others accordingly
		
		d3.selectAll("path.segment-"+d.Day).style("opacity", function (p) {return 0.6});
		
        tooltip.select('.time').html("<b> Time: " + d.Time + "</b>");
        tooltip.select('.day').html("<b> Date: " + d.Day + "</b>");
        tooltip.select('.average').html("<b> Value: " + d.Average + "</b>");
        tooltip.style('display', 'block');
        tooltip.style('opacity',2);
    })
    .on('mousemove', function(d) {
        tooltip.style('top', (d3.event.layerY + 10) + 'px')
        .style('left', (d3.event.layerX - 25) + 'px');
    })
    .on('mouseout', function(d) {
        tooltip.style('display', 'none');
        tooltip.style('opacity',0);
       //  var time = d.Time;
	   //  var timeCleaned = time.split(":").join("-");
	   //  var segment = d3.select("#segment-"+d.Day +"-"+timeCleaned); //designate selector variable for brevity
	   //  var fillcolor = segment.select("desc").text();  //access original color from desc
       //  segment.style("fill", fillcolor);
		
		d3.selectAll("path.segment-"+d.Day).style("opacity", function (p) {return 1});
    })
    .append("desc") //append the current color as a desc element
	.text(function(d){ 
			var color = d3.scale.linear().domain([0,0.5,1]).range(["#ffffd9", "#7fcdbb" ,"#225ea8"]);
			// how to access a function within reusable charts
			console.log(color(d.Average));
			return color(d.Average);
		});
	}

function circularHeatChart() {
    var margin = {top: 20, right: 50, bottom: 50, left: 20},
    innerRadius = 20,
    numSegments = 24,
    segmentHeight = 20,
    domain = null,
    range = ["white", "red"],
    accessor = function(d) {return d;},
    radialLabels = segmentLabels = [];

    function chart(selection) {
        selection.each(function(data) {
            var svg = d3.select(this);

            var offset = innerRadius + Math.ceil(data.length / numSegments) * segmentHeight;
            g = svg.append("g")
                .classed("circular-heat", true)
                .attr("transform", "translate(" + parseInt(margin.left + offset) + "," + parseInt(margin.top + offset) + ")");

            var autoDomain = false;
            if (domain === null) {
                domain = d3.extent(data, accessor);
                autoDomain = true;
            }
            var color = d3.scale.linear().domain(domain).range(range);
            if(autoDomain)
                domain = null;

            g.selectAll("path").data(data)
                .enter().append("path")
                // .attr("class","segment")
                .attr("class",function(d){return "segment-"+d.Day})
                .attr("id",function(d){
                	 var time = d.Time;
                	 var timeCleaned = time.split(":").join("-");
               		 return "segment-"+d.Day +"-"+timeCleaned;})
                .attr("d", d3.svg.arc().innerRadius(ir).outerRadius(or).startAngle(sa).endAngle(ea))
                .attr("stroke", function(d) {return '#252525';})
                .attr("fill", function(d) {return color(accessor(d));});
                
            // Unique id so that the text path defs are unique - is there a better way to do this?
            var id = d3.selectAll(".circular-heat")[0].length;


            //Segment labels
            var segmentLabelOffset = 5;
            var r = innerRadius + Math.ceil(data.length / numSegments) * segmentHeight + segmentLabelOffset;
            labels = svg.append("g")
                .classed("labels", true)
                .classed("segment", true)
                .attr("transform", "translate(" + parseInt(margin.left + offset) + "," + parseInt(margin.top + offset) + ")");

            labels.append("def")
                .append("path")
                .attr("id", "segment-label-path-"+id)
                .attr("d", "m0 -" + r + " a" + r + " " + r + " 0 1 1 -1 0");

            labels.selectAll("text")
                .data(segmentLabels).enter()
                .append("text")
                .append("textPath")
                .attr("xlink:href", "#segment-label-path-"+id)
                .style("font-size", "12px")
                .attr("startOffset", function(d, i) {return i * 100 / numSegments + 1.5+ "%";})
                .text(function(d) {return d;});
        });

    }

    /* Arc functions */
    ir = function(d, i) {
        return innerRadius + Math.floor(i/numSegments) * segmentHeight;
    }
    or = function(d, i) {
        return innerRadius + segmentHeight + Math.floor(i/numSegments) * segmentHeight;
    }
    sa = function(d, i) {
        return (i * 2 * Math.PI) / numSegments;
    }
    ea = function(d, i) {
        return ((i + 1) * 2 * Math.PI) / numSegments;
    }

    /* Configuration getters/setters */
    chart.margin = function(_) {
        if (!arguments.length) return margin;
        margin = _;
        return chart;
    };

    chart.innerRadius = function(_) {
        if (!arguments.length) return innerRadius;
        innerRadius = _;
        return chart;
    };

    chart.numSegments = function(_) {
        if (!arguments.length) return numSegments;
        numSegments = _;
        return chart;
    };

    chart.segmentHeight = function(_) {
        if (!arguments.length) return segmentHeight;
        segmentHeight = _;
        return chart;
    };

    chart.domain = function(_) {
        if (!arguments.length) return domain;
        domain = _;
        return chart;
    };

    chart.range = function(_) {
        if (!arguments.length) return range;
        range = _;
        return chart;
    };

    chart.radialLabels = function(_) {
        if (!arguments.length) return radialLabels;
        if (_ == null) _ = [];
        radialLabels = _;
        return chart;
    };

    chart.segmentLabels = function(_) {
        if (!arguments.length) return segmentLabels;
        if (_ == null) _ = [];
        segmentLabels = _;
        return chart;
    };

    chart.accessor = function(_) {
        if (!arguments.length) return accessor;
        accessor = _;
        return chart;
    };

    return chart;
}
